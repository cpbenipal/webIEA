"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),_get=function(n,t,i){var e=!0,r,f,o;n:while(e){var u=n,s=t,h=i;if(e=!1,u===null&&(u=Function.prototype),r=Object.getOwnPropertyDescriptor(u,s),r===undefined){if(f=Object.getPrototypeOf(u),f===null)return undefined;n=f;t=s;i=h;e=!0;r=f=undefined;continue n}else return"value"in r?r.value:(o=r.get,o===undefined)?undefined:o.call(h)}},EventManager=EventManager||{},EventManagerPendingEvents=function(n){function t(){var e,i,u,f,n,r;_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);EventManager.bus.installTo(this);e=this;for(i in EventManager.settings.Events.pendingEvents)u=this[i],f=EventManager.settings.Events.pendingEvents[i],EventManager.bus.subscribe(f,u);n=6e4;r=setInterval(function(){EventManager.bus.publish(EventManager.settings.Events.pendingEvents.refresh,{})},n);setInterval(function(){var t=$("[name='RefreshEvery']input").val();t=parseInt(t)*1e3;t!=n&&(n=t,clearInterval(r),r=setInterval(function(){EventManager.bus.publish(EventManager.settings.Events.pendingEvents.refresh,{})},n))},3e3)}return _inherits(t,n),_createClass(t,[{key:"start",value:function(n){n.requestUrl="Admin/PendingEvents_Start";n.requestParameters={};n.callbackSucceed=function(n){$(".fp_pendingEvents-settings").html(n)};EventManager.bus.publish(EventManager.settings.Events.service.setPendingEvents,n)}},{key:"stop",value:function(n){n.requestUrl="Admin/PendingEvents_Stop";n.requestParameters={};n.callbackSucceed=function(n){$(".fp_pendingEvents-settings").html(n)};EventManager.bus.publish(EventManager.settings.Events.service.setPendingEvents,n)}},{key:"setDelay",value:function(n){n.requestUrl="Admin/PendingEvents_SetDelay";var t=$("#QueueDelay input").val();n.requestParameters={delay:t};n.callbackSucceed=function(n){$(".fp_pendingEvents-settings").html(n)};EventManager.bus.publish(EventManager.settings.Events.service.setPendingEvents,n)}},{key:"refresh",value:function(){fp_PendingEvents_File_Grid.Refresh();fp_PendingEvents_Notification_Grid.Refresh()}},{key:"showContextMenu",value:function(n){n.blockCss="#fp_"+n.typeBlock+"_Grid_DXMainTable";var t=n.event;(t.type="click",n.$elemClick=$(n.event.htmlEvent.target),n=EventManager.tools.showContextMenu_CheckAttrs(n),n!=null)&&(n=EventManager.tools.showContextMenu_CopyAttrs(n),n=EventManager.tools.showContextMenu(n))}},{key:"clickContextMenu",value:function(n){n.event.item&&(n=EventManager.tools.clickContextMenu_GetAttrs(n),n.requestUrl="Admin/"+n.typeBlock+n.event.item.name,n.requestParameters={ID:n.rowId,contactID:n.contactID,address:n.address},n.callbackSucceed=function(){EventManager.bus.publish(EventManager.settings.Events.pendingEvents.refresh,{})},n.event.item.name==="Delete"&&EventManager.bus.publish(EventManager.settings.Events.service.setPendingEvents,n))}}]),t}(EventManagerBase);