"use strict";var EventManager=EventManager||{};EventManager.tools={};EventManager.tools.CallbackFailed=function(n,t,i,r){return EventManager.tools.hideLoading(r),EventManager.tools.FailedMessage("error ID = "+r.ID+" error : "+n.statusText),null};EventManager.tools.CallbackFailedDialogFailed=function(n,t,i,r){return EventManager.tools.hideLoading(r),fp_ConfirmDialog("Error","An error has occurred, contact your system administrator.",function(){}),EventManager.tools.FailedMessage("error ID = "+r.ID+" error : "+n.statusText),null};EventManager.tools.FailedMessage=function(n,t){fp_settings.debug==!0&&(console.log(n),console.log(t))};EventManager.tools.CallbackError=function(n,t,i,r,u,f,e){fp_ConfirmDialog(u.error.title,u.error.message,f?f:function(){},e?e:function(){});fp_settings.debug==!0&&(console.log(u.error.title),console.log(u.error.message))};EventManager.tools.CallbackSuccess=function(n,t,i,r,u){fp_ConfirmDialog(u.title,u.message,function(){})};EventManager.tools.UpdateBlock=function(n,t,i,r){var u=$("#b"+r.ID+" ."+r.classBlock+"");u.removeClass("fp_freeze");u.length>0?($(u.first()).html(n),fp_settings.debug==!0&&console.log("UpdateBlock "+r.ID)):EventManager.tools.FailedMessage("no update "+r.classBlock);EventManager.tools.hideLoading(r)};EventManager.tools.RefreshGrid=function(n){var t=$("#b"+n.ID+" ."+n.classBlock+""),i=window["fp_refresh"+n.ID];t.removeClass("fp_freeze");t.length>0&&typeof i=="function"?(i(),fp_settings.debug==!0&&console.log("RefreshGrid "+n.ID)):EventManager.tools.FailedMessage("no update "+n.classBlock);EventManager.tools.hideLoading(n)};EventManager.tools.UpdateTab=function(n,t,i,r){var u=$("#b"+r.ID+" ."+r.classBlock+"");u.removeClass("fp_freeze");u=u.find("#tabControl"+r.ID+"_C"+r.selectTabIndex+" div");u.length>0?(EventManagerContactDetails.unbind(r),$(u.first()).html(n),EventManagerContactDetails.bind(r),fp_settings.debug==!0&&console.log("UpdateTab "+r.ID)):EventManager.tools.FailedMessage("no update tab "+r.classBlock);EventManager.tools.hideLoading(r)};EventManager.tools.showLoading=function(n){var r,t,u,i;EventManager.tools.hideLoading(n);r=$("#b"+n.ID+" ."+n.classBlock);r.addClass("fp_freeze");t=$("."+n.classBlock+"LoadingPanel #LoadingPanel"+n.ID);u=n.loadingLeft;typeof n.loadingLeft=="undefined"&&(u=(r.width()-t.width())/2);i=n.loadingTop;typeof n.loadingTop=="undefined"&&(i=(r.height()-t.height())/2,i=Math.min(i,100));t.css({left:u,top:i});t.show();fp_settings.debug==!0};EventManager.tools.hideLoading=function(n){var t=$("."+n.classBlock+"LoadingPanel #LoadingPanel"+n.ID);t.hide();fp_settings.debug==!0};EventManager.tools.getItemsBlocks=function(n,t){return fp_settings.debug==!0&&console.log($(".fp"+n+" [data-alias='"+t+"']")),$(".fp"+n+" [data-alias='"+t+"']")};EventManager.tools.showContextMenu=function(n){typeof n.pageY=="undefined"&&(n.pageY=n.event.htmlEvent.pageY);typeof n.pageX=="undefined"&&(n.pageX=n.event.htmlEvent.pageX);var t=n.pageY-$(n.blockCss).offset().top,i=n.pageX-$(n.blockCss).offset().left;return n.$contextMenu=$("#PopupMenu"+n.ID),eval("PopupMenu"+n.ID+".ShowAtPos("+n.pageX+", "+n.pageY+")"),n};EventManager.tools.showContextMenu_CopyAttrs=function(n){return n.rowId&&$("#PopupMenu"+n.ID).attr("data-rowId",n.rowId),n.parentId&&$("#PopupMenu"+n.ID).attr("data-parentId",n.parentId),n.path&&$("#PopupMenu"+n.ID).attr("data-path",n.path),n.contactType&&$("#PopupMenu"+n.ID).attr("data-contactType",n.contactType),n.name&&$("#PopupMenu"+n.ID).attr("data-name",n.name),n.level&&$("#PopupMenu"+n.ID).attr("data-level",n.level),n.typeBlock&&$("#PopupMenu"+n.ID).attr("data-typeBlock",n.typeBlock),n.contactID&&$("#PopupMenu"+n.ID).attr("data-contactID",n.contactID),n.shortcutId&&$("#PopupMenu"+n.ID).attr("data-shortcut-id",n.shortcutId),n.address&&$("#PopupMenu"+n.ID).attr("data-address",n.address),n};EventManager.tools.showContextMenu_CheckAttrs=function(n){return(n.rowId=$(n.$elemClick).attr("data-rowId"),typeof n.rowId=="undefined"&&(n.$elemClick=$(n.$elemClick).find("."+n.classRow),n.rowId=n.$elemClick.attr("data-rowId")),typeof n.rowId=="undefined"&&(n.$elemClick=$(n.$elemClick).closest("."+n.classRow),n.rowId=n.$elemClick.attr("data-rowId")),typeof n.rowId=="undefined")?(fp_settings.debug==!0&&(console.log("rowId = undefined"),console.log(n.$elemClick)),null):(n.contactType=n.$elemClick.attr("data-contactType"),n.parentId=n.$elemClick.attr("data-parentId"),n.contactID=n.$elemClick.attr("data-contactID"),n.shortcutId=n.$elemClick.attr("data-shortcut-id"),n.address=n.$elemClick.attr("data-address"),n)};EventManager.tools.clickContextMenu_GetAttrs=function(n){return(n.$popup=$("#PopupMenu"+n.ID),n.rowId=n.$popup.attr("data-rowId"),n.path=n.$popup.attr("data-path"),n.parentId=n.$popup.attr("data-parentId"),n.contactType=n.$popup.attr("data-contactType"),n.typeBlock||(n.typeBlock=n.$popup.attr("data-typeBlock")),n.contactID=n.$popup.attr("data-contactID"),n.shortcutId=n.$popup.attr("data-shortcut-id"),n.address=n.$popup.attr("data-address"),n.$block=$("#b"+n.ID+" ."+n.classBlock+"[data-name],.flexpage-blockWrapper#b"+n.ID+" ."+n.classBlock+"[data-alias]"),n.name=n.$block.attr("data-name"),n.alias=n.$block.attr("data-alias"),typeof n.rowId=="undefined")?(fp_settings.debug==!0&&(console.log("rowId = undefined"),console.log(n.$popup)),null):n};EventManager.tools.applyRename=function(n){typeof n.type=="undefined"&&(n.type="click");EventManager.bus.publish(EventManager.settings.Events.hideAllContextMenu,{event:n});EventManager.bus.publish(EventManager.settings.Events.folderTreeList.renameApplyFolder,{event:n});EventManager.bus.publish(EventManager.settings.Events.folderContent.renameApplyFile,{event:n})};EventManager.tools.focus=function(n){var t=n.$input.val();return n.$input.val(""),n.$input.focus(),n.$input.val(t),n};EventManager.tools.getBrowser=function(n){return n.$browser=$(".fp_browser,.fpBrowserContacts"),n.$browser.length>0&&(n.$browser.ID=n.$browser.attr("id"),n.$browser.ID&&(n.$browser.ID=n.$browser.ID.replace("fp_browser","").replace("b",""),n.$browser.ID=parseInt(n.$browser.ID))),n};EventManager.tools.get_cookie=function(n){var t=document.cookie.match(new RegExp("(^| )"+n+"=([^;]+)"));if(t)return decodeURIComponent(t[2])};EventManager.tools.set_cookie=function(n,t,i,r){setTimeout(function(){var u=r?"; domain="+r:"";document.cookie=n+"="+encodeURIComponent(t)+"; max-age="+i+"; path=/"+u},0)};EventManager.tools.delete_cookie=function(n,t){var i=t?"; domain="+t:"";document.cookie=n+"=; max-age=0; path=/"+i};