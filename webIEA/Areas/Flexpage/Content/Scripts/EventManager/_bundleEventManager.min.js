"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var EventManager=EventManager||{},_createClass,EventManagerBase,eventManagerBase;EventManager.bus=function(){var n={},t=function(t,i){var r=this;return n[t]||(n[t]=[]),fp_settings.debug==!0,n[t].some(function(n){return n.callback===i&&n.context===r})||n[t].push({context:this,callback:i}),this},i=function(t){var u,i,f,r;if(!n[t])return!1;for(u=Array.prototype.slice.call(arguments,1),i=0,f=n[t].length;i<f;i++){r=n[t][i];try{fp_settings.debug==!0&&console.log("publish: "+t);r.callback.apply(r.context,u)}catch(e){EventManager.tools.FailedMessage("Event "+t+" error: "+e,n)}}return this};return{publish:i,subscribe:t,installTo:function(n){n.subscribe=t;n.publish=i}}}();EventManager=EventManager||{};EventManager.service=function(){var l=function(){var n,t,i;EventManager.bus.installTo(this);for(n in EventManager.settings.Events.service)t=this[n],i=EventManager.settings.Events.service[n],EventManager.bus.subscribe(i,t)},r=function(n,t,i,r){var u={};try{u=JSON.parse(n)}catch(f){r.callbackSucceed(n,t,i,r,u);return}u.error?r.callbackError(n,t,i,r,u):r.callbackSucceed(n,t,i,r,u)},u=function(n,t,i,r){r.callbackFailed(n,t,i,r)},f=function(n){$.ajax({url:document.location.origin+"/"+n.requestUrl,data:n.requestParameters,type:"GET",cache:!0,success:function(t,i,u){r(t,i,u,n)},error:function(t,i,r){u(t,i,r,n)}})},a=function(n){$.ajax({url:document.location.origin+"/"+n.requestUrl,data:n.requestParameters,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(t,i,u){r(t,i,u,n);h()},error:function(t,i,r){u(t,i,r,n);h()}})},v=function(n){$.ajax({url:document.location.origin+"/"+n.requestUrl,data:n.requestParameters,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(t,i,u){r(t,i,u,n)},error:function(t,i,r){u(t,i,r,n)}})},n=function(n){$.ajax({url:document.location.origin+"/"+n.requestUrl,data:n.requestParameters,type:"POST",cache:!0,"async":n.async==="undefined"?!0:n.async,success:function(t,i,u){r(t,i,u,n)},error:function(t,i,r){u(t,i,r,n)}})},t=function(n){return typeof n.callbackSucceed=="undefined"&&(n.callbackSucceed=EventManager.tools.UpdateBlock),typeof n.callbackFailed=="undefined"&&(n.callbackFailed=EventManager.tools.CallbackFailed),typeof n.callbackError=="undefined"&&(n.callbackError=EventManager.tools.CallbackError),n},ot=function(n){return typeof n.callbackSucceed=="undefined"&&(n.callbackSucceed=EventManager.tools.RefreshGrid),typeof n.callbackFailed=="undefined"&&(n.callbackFailed=EventManager.tools.CallbackFailedDialogFailed),typeof n.callbackError=="undefined"&&(n.callbackError=EventManager.tools.CallbackFailedDialogFailed),n},o=function(n){return typeof n.callbackSucceed=="undefined"&&(n.callbackSucceed=EventManager.tools.RefreshGrid),typeof n.callbackFailed=="undefined"&&(n.callbackFailed=EventManager.tools.CallbackFailed),typeof n.callbackError=="undefined"&&(n.callbackError=EventManager.tools.CallbackError),n},s=function(n){return typeof n.callbackSucceed=="undefined"&&(n.callbackSucceed=EventManager.tools.CallbackSuccess),typeof n.callbackFailed=="undefined"&&(n.callbackFailed=EventManager.tools.CallbackFailed),typeof n.callbackError=="undefined"&&(n.callbackError=EventManager.tools.CallbackError),n},y=function(n){n=t(n);f(n)},p=function(t){t=o(t);n(t)},w=function(t){t=o(t);n(t)},b=function(i){i=t(i);n(i)},st=function(n){n=t(n);f(n)},k=function(i){i=t(i);n(i)},d=function(i){i=t(i);n(i)},g=function(i){i=t(i);n(i)},nt=function(n){tt();n=t(n);n.processData=!1;a(n)},e=!1,tt=function(){e=!0;var n=setInterval(function(){var t=$(".uploadFileWaitBlock").css("bottom");$(".uploadFileWaitBlock").css("bottom",parseInt(t)+1);20<=parseInt(t)&&(clearInterval(n),e=!1)},5)},h=function(){$(".uploadFileWaitBlock").show();var n=$(".uploadFileWaitBlock"),t=n.height(),i=parseInt(n.css("padding-top"))*2+21,r=(t+i)*-1,u=setInterval(function(){var n=$(".uploadFileWaitBlock").css("bottom");console.log(">>>",e);e||($(".uploadFileWaitBlock").css("bottom",parseInt(n)-1),r>=parseInt(n)&&clearInterval(u))},5)},it=function(n){n=t(n);f(n)},rt=function(n){n=t(n);f(n)},ut=function(i){i=t(i);n(i)},c=function(t){t=o(t);n(t)},i=function(t){t=s(t);n(t)},ft=function(n){n=s(n);v(n)},et=function(t){t=s(t);n(t)};return{init:l,updateByPathFolder:y,addContactToFolder:p,deleteContactToFolder:w,createFolder:b,renameApplyFolder:k,renameApplyFile:c,deleteFolder:d,deleteFile:g,uploadFile:nt,expandedChanging:it,updateContactDetails:rt,saveContactDetails:ut,saveCustomProperties:i,getCustomPropertyShowContact:i,setContactsAdvancedSearch:i,setPendingEvents:i,addNewContact:i,resetPublishingOverrides:i,resetTimeToLeave:i,paste:ft,treelistClickNode:i,deleteContact:c,faqQuestionEdit:et}}();EventManager=EventManager||{};EventManager.tools={};EventManager.tools.CallbackFailed=function(n,t,i,r){return EventManager.tools.hideLoading(r),EventManager.tools.FailedMessage("error ID = "+r.ID+" error : "+n.statusText),null};EventManager.tools.CallbackFailedDialogFailed=function(n,t,i,r){return EventManager.tools.hideLoading(r),fp_ConfirmDialog("Error","An error has occurred, contact your system administrator.",function(){}),EventManager.tools.FailedMessage("error ID = "+r.ID+" error : "+n.statusText),null};EventManager.tools.FailedMessage=function(n,t){fp_settings.debug==!0&&(console.log(n),console.log(t))};EventManager.tools.CallbackError=function(n,t,i,r,u,f,e){fp_ConfirmDialog(u.error.title,u.error.message,f?f:function(){},e?e:function(){});fp_settings.debug==!0&&(console.log(u.error.title),console.log(u.error.message))};EventManager.tools.CallbackSuccess=function(n,t,i,r,u){fp_ConfirmDialog(u.title,u.message,function(){})};EventManager.tools.UpdateBlock=function(n,t,i,r){var u=$("#b"+r.ID+" ."+r.classBlock+"");u.removeClass("fp_freeze");u.length>0?($(u.first()).html(n),fp_settings.debug==!0&&console.log("UpdateBlock "+r.ID)):EventManager.tools.FailedMessage("no update "+r.classBlock);EventManager.tools.hideLoading(r)};EventManager.tools.RefreshGrid=function(n){var t=$("#b"+n.ID+" ."+n.classBlock+""),i=window["fp_refresh"+n.ID];t.removeClass("fp_freeze");t.length>0&&typeof i=="function"?(i(),fp_settings.debug==!0&&console.log("RefreshGrid "+n.ID)):EventManager.tools.FailedMessage("no update "+n.classBlock);EventManager.tools.hideLoading(n)};EventManager.tools.UpdateTab=function(n,t,i,r){var u=$("#b"+r.ID+" ."+r.classBlock+"");u.removeClass("fp_freeze");u=u.find("#tabControl"+r.ID+"_C"+r.selectTabIndex+" div");u.length>0?(EventManagerContactDetails.unbind(r),$(u.first()).html(n),EventManagerContactDetails.bind(r),fp_settings.debug==!0&&console.log("UpdateTab "+r.ID)):EventManager.tools.FailedMessage("no update tab "+r.classBlock);EventManager.tools.hideLoading(r)};EventManager.tools.showLoading=function(n){var r,t,u,i;EventManager.tools.hideLoading(n);r=$("#b"+n.ID+" ."+n.classBlock);r.addClass("fp_freeze");t=$("."+n.classBlock+"LoadingPanel #LoadingPanel"+n.ID);u=n.loadingLeft;typeof n.loadingLeft=="undefined"&&(u=(r.width()-t.width())/2);i=n.loadingTop;typeof n.loadingTop=="undefined"&&(i=(r.height()-t.height())/2,i=Math.min(i,100));t.css({left:u,top:i});t.show();fp_settings.debug==!0};EventManager.tools.hideLoading=function(n){var t=$("."+n.classBlock+"LoadingPanel #LoadingPanel"+n.ID);t.hide();fp_settings.debug==!0};EventManager.tools.getItemsBlocks=function(n,t){return fp_settings.debug==!0&&console.log($(".fp"+n+" [data-alias='"+t+"']")),$(".fp"+n+" [data-alias='"+t+"']")};EventManager.tools.showContextMenu=function(n){typeof n.pageY=="undefined"&&(n.pageY=n.event.htmlEvent.pageY);typeof n.pageX=="undefined"&&(n.pageX=n.event.htmlEvent.pageX);var t=n.pageY-$(n.blockCss).offset().top,i=n.pageX-$(n.blockCss).offset().left;return n.$contextMenu=$("#PopupMenu"+n.ID),eval("PopupMenu"+n.ID+".ShowAtPos("+n.pageX+", "+n.pageY+")"),n};EventManager.tools.showContextMenu_CopyAttrs=function(n){return n.rowId&&$("#PopupMenu"+n.ID).attr("data-rowId",n.rowId),n.parentId&&$("#PopupMenu"+n.ID).attr("data-parentId",n.parentId),n.path&&$("#PopupMenu"+n.ID).attr("data-path",n.path),n.contactType&&$("#PopupMenu"+n.ID).attr("data-contactType",n.contactType),n.name&&$("#PopupMenu"+n.ID).attr("data-name",n.name),n.level&&$("#PopupMenu"+n.ID).attr("data-level",n.level),n.typeBlock&&$("#PopupMenu"+n.ID).attr("data-typeBlock",n.typeBlock),n.contactID&&$("#PopupMenu"+n.ID).attr("data-contactID",n.contactID),n.shortcutId&&$("#PopupMenu"+n.ID).attr("data-shortcut-id",n.shortcutId),n.address&&$("#PopupMenu"+n.ID).attr("data-address",n.address),n};EventManager.tools.showContextMenu_CheckAttrs=function(n){return(n.rowId=$(n.$elemClick).attr("data-rowId"),typeof n.rowId=="undefined"&&(n.$elemClick=$(n.$elemClick).find("."+n.classRow),n.rowId=n.$elemClick.attr("data-rowId")),typeof n.rowId=="undefined"&&(n.$elemClick=$(n.$elemClick).closest("."+n.classRow),n.rowId=n.$elemClick.attr("data-rowId")),typeof n.rowId=="undefined")?(fp_settings.debug==!0&&(console.log("rowId = undefined"),console.log(n.$elemClick)),null):(n.contactType=n.$elemClick.attr("data-contactType"),n.parentId=n.$elemClick.attr("data-parentId"),n.contactID=n.$elemClick.attr("data-contactID"),n.shortcutId=n.$elemClick.attr("data-shortcut-id"),n.address=n.$elemClick.attr("data-address"),n)};EventManager.tools.clickContextMenu_GetAttrs=function(n){return(n.$popup=$("#PopupMenu"+n.ID),n.rowId=n.$popup.attr("data-rowId"),n.path=n.$popup.attr("data-path"),n.parentId=n.$popup.attr("data-parentId"),n.contactType=n.$popup.attr("data-contactType"),n.typeBlock||(n.typeBlock=n.$popup.attr("data-typeBlock")),n.contactID=n.$popup.attr("data-contactID"),n.shortcutId=n.$popup.attr("data-shortcut-id"),n.address=n.$popup.attr("data-address"),n.$block=$("#b"+n.ID+" ."+n.classBlock+"[data-name],.flexpage-blockWrapper#b"+n.ID+" ."+n.classBlock+"[data-alias]"),n.name=n.$block.attr("data-name"),n.alias=n.$block.attr("data-alias"),typeof n.rowId=="undefined")?(fp_settings.debug==!0&&(console.log("rowId = undefined"),console.log(n.$popup)),null):n};EventManager.tools.applyRename=function(n){typeof n.type=="undefined"&&(n.type="click");EventManager.bus.publish(EventManager.settings.Events.hideAllContextMenu,{event:n});EventManager.bus.publish(EventManager.settings.Events.folderTreeList.renameApplyFolder,{event:n});EventManager.bus.publish(EventManager.settings.Events.folderContent.renameApplyFile,{event:n})};EventManager.tools.focus=function(n){var t=n.$input.val();return n.$input.val(""),n.$input.focus(),n.$input.val(t),n};EventManager.tools.getBrowser=function(n){return n.$browser=$(".fp_browser,.fpBrowserContacts"),n.$browser.length>0&&(n.$browser.ID=n.$browser.attr("id"),n.$browser.ID&&(n.$browser.ID=n.$browser.ID.replace("fp_browser","").replace("b",""),n.$browser.ID=parseInt(n.$browser.ID))),n};EventManager.tools.get_cookie=function(n){var t=document.cookie.match(new RegExp("(^| )"+n+"=([^;]+)"));if(t)return decodeURIComponent(t[2])};EventManager.tools.set_cookie=function(n,t,i,r){setTimeout(function(){var u=r?"; domain="+r:"";document.cookie=n+"="+encodeURIComponent(t)+"; max-age="+i+"; path=/"+u},0)};EventManager.tools.delete_cookie=function(n,t){var i=t?"; domain="+t:"";document.cookie=n+"=; max-age=0; path=/"+i};_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();EventManager=EventManager||{};EventManager.settings={debug:fp_settings.debug,PathJs:{treeList:"/Areas/Flexpage/Content/Scripts/TreeList/EventManagerTreeList.es5.min.js",contactsEnumeration:"/Areas/Flexpage/Content/Scripts/ContactsEnumeration/_bundleContactsEnumeration.min.js",folderContent:"/Areas/Flexpage/Content/Scripts/FolderContent/_bundleFolderContent.min.js",browser:"/Areas/Flexpage/Content/Scripts/Browser/EventManagerBrowser.es5.min.js",browserContacts:"/Areas/Flexpage/Content/Scripts/BrowserContacts/EventManagerBrowserContacts.es5.min.js",contactDetails:"/Areas/Flexpage/Content/Scripts/ContactDetails/EventManagerContactDetails.es5.min.js",customProperties:"/Areas/Flexpage/Content/Scripts/CustomProperties/EventManagerCustomProperties.es5.min.js",contactsAdvancedSearch:"/Areas/Flexpage/Content/Scripts/ContactsAdvancedSearch/EventManagerContactsAdvancedSearch.es5.min.js",pendingEvents:"/Areas/Flexpage/Content/Scripts/PendingEvents/EventManagerPendingEvents.es5.min.js",enums:"/Areas/Flexpage/Content/Scripts/Enums/EventManagerEnums.es5.min.js",browserSearch:"/Areas/Flexpage/Content/Scripts/BrowserSearch/EventManagerBrowserSearch.es5.min.js",faq:"/Areas/Flexpage/Content/Scripts/FAQ/EventManagerFAQ.es5.min.js",faqEdit:"/Areas/Flexpage/Content/Scripts/FAQ/EventManagerFAQEdit.es5.min.js"},Events:{hideAllContextMenu:"hideAllContextMenu",folderTreeList:{initUpload:"folderTreeList_InitUpload",showContextMenu:"folderTreeList_ShowContextMenu",clickNode:"folderTreeList_ClickNode",clickContextMenu:"folderTreeList_ClickContextMenu",renameApplyFolder:"renameApplyFolder",expandedChangingFolder:"folderTreeList_ExpandedChangingFolder",selectionChanged:"folderTreeList_SelectionChanged",endCallback:"folderTreeList_endCallback"},contactsEnumeration:{updateByPathFolder:"contactsEnumeration_UpdateByPathFolder",detailToggleButton:"contactsEnumeration_DetailToggleButton",rowClick:"contactsEnumeration_RowClick",showContextMenu:"contactsEnumeration_ShowContextMenu",clickContextMenu:"contactsEnumeration_ClickContextMenu",updateGeneralInfo:"contactsEnumeration_UpdateGeneralInfo",updateTelecoms:"contactsEnumeration_UpdateTelecoms",addContactToFolder:"contactsEnumeration_AddContactToFolder",addPerson:"contactsEnumeration_AddPerson",addCompany:"contactsEnumeration_AddCompany",deleteContactToFolder:"contactsEnumeration_DeleteContactToFolder",updateCustomProperties:"contactsEnumeration_UpdateCustomProperties",addNewContact:"contactsEnumeration_AddNewContact",deleteContact:"contactsEnumeration_deleteContact",endCallback:"contactsEnumeration_endCallback"},contactDetails:{tabClick:"contactDetails_TabClick",edit:"contactDetails_Edit",save:"contactDetails_Save",cancel:"contactDetails_Cancel"},browser:{updateByPathFolder:"browser_UpdateByPathFolder",endCallback:"browser_EndCallback"},browserSearch:{showContextMenu:"browserSearch_ShowContextMenu",clickContextMenu:"browserSearch_ClickContextMenu",downloadZip:"browserSearch_downloadZip"},browserContacts:{endCallback:"browserContacts_EndCallback"},folderContent:{initUpload:"folderContent_InitUpload",updateByPathFolder:"folderContent_UpdateByPathFolder",showContextMenu:"folderContent_ShowContextMenu",clickContextMenu:"folderContent_clickContextMenu",renameApplyFile:"renameApplyFile",uploadFile:"uploadFile",detailToggleButton:"folderContent_detailToggleButton",downloadZip:"folderContent_downloadZip",endCallback:"folderContent_endCallback"},contactsAdvancedSearch:{search:"contactsAdvancedSearch_search",exportToFile:"contactsAdvancedSearch_exportToFile",importToFile:"contactsAdvancedSearch_importToFile",openToBrowser:"contactsAdvancedSearch_openToBrowser",openFile:"contactsAdvancedSearch_openFile",saveToFolder:"contactsAdvancedSearch_saveToFolder",linkFolder:"contactsAdvancedSearch_linkFolder",saveXmlChanges:"contactsAdvancedSearch_saveXmlChanges",setHistoryStep:"contactsAdvancedSearch_setHistoryStep",newFile:"contactsAdvancedSearch_newFile"},pendingEvents:{start:"pendingEvents_start",stop:"pendingEvents_stop",setDelay:"pendingEvents_setDelay",refresh:"pendingEvents_refresh",showContextMenu:"pendingEvents_showContextMenu",clickContextMenu:"pendingEvents_clickContextMenu"},customProperties:{},faqEdit:{changeLanguageQuestionEdit:"faq_changeLanguageQuestionEdit"},faq:{filter:"faq_filter"},service:{updateByPathFolder:"service_updateByPathFolder",createFolder:"service_createFolder",renameApplyFolder:"service_renameApplyFolder",deleteFolder:"service_deleteFolder",renameApplyFile:"service_renameApplyFile",deleteFile:"service_deleteFile",uploadFile:"service_uploadFile",expandedChanging:"service_expandedChanging",updateContactDetails:"service_updateContactDetails",saveContactDetails:"service_saveContactDetails",addContactToFolder:"service_addContactToFolder",deleteContactToFolder:"service_deleteContactToFolder",saveCustomProperties:"service_saveCustomProperties",getCustomPropertyShowContact:"service_getCustomPropertyShowContact",setContactsAdvancedSearch:"service_setContactsAdvancedSearch",setPendingEvents:"service_setPendingEvents",addNewContact:"service_addNewContact",resetPublishingOverrides:"service_resetPublishingOverrides",resetTimeToLeave:"service_resetTimeToLeave",paste:"service_paste",treelistClickNode:"service_treelistClickNode",deleteContact:"service_deleteContact",faqQuestionEdit:"service_faqQuestionEdit"}}};EventManagerBase=function(){function n(){_classCallCheck(this,n);EventManager.bus.installTo(this);EventManager.bus.subscribe(EventManager.settings.Events.hideAllContextMenu,this.hideAllContextMenu)}return _createClass(n,[{key:"hideAllContextMenu",value:function(){$("[class*='dxmLite'] > div").attr("style","display:none;")}}]),n}();eventManagerBase=new EventManagerBase;EventManager.init=function(){EventManager.service.init()};EventManager.init();